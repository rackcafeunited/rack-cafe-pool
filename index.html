<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rack Café Utd</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body{margin:0;font-family:system-ui,Arial,sans-serif;background:#0f172a;color:#e5e7eb}
    header{background:#020617;padding:14px 18px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #1e293b;gap:12px;flex-wrap:wrap}
    nav{padding:12px 18px;border-bottom:1px solid #1e293b;background:#0b1220;position:sticky;top:0;z-index:5}
    nav button{background:none;border:none;color:#94a3b8;margin-right:12px;font-weight:700;cursor:pointer;padding:8px 10px;border-radius:10px}
    nav button.active{color:#38bdf8;background:rgba(56,189,248,.08)}
    .container{padding:20px;max-width:1100px;margin:0 auto}
    .card{background:#020617;padding:18px;border-radius:14px;margin-bottom:16px;border:1px solid #1e293b}
    .hidden{display:none}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #1e293b;text-align:left}
    th{color:#94a3b8;font-size:12px;text-transform:uppercase;letter-spacing:.06em}
    .badge{padding:4px 10px;border-radius:999px;font-size:12px;border:1px solid #1e293b;display:inline-flex;align-items:center;gap:8px}
    .ok{color:#22c55e}
    .warn{color:#f59e0b}
    .danger{color:#ef4444}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row > *{flex:1;min-width:180px}
    .frames{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-top:12px}
    select,input{width:100%;padding:10px 10px;border-radius:10px;border:1px solid #1e293b;background:#020617;color:#e5e7eb}
    button.primary{padding:10px 14px;border-radius:12px;border:none;background:#38bdf8;color:#020617;font-weight:900;cursor:pointer}
    button.secondary{padding:10px 14px;border-radius:12px;border:1px solid #1e293b;background:transparent;color:#e5e7eb;cursor:pointer}
    button.secondary:disabled,button.primary:disabled{opacity:.55;cursor:not-allowed}
    .fixture{padding:12px;border:1px solid #1e293b;border-radius:12px;margin-top:10px;display:flex;justify-content:space-between;gap:12px;align-items:center}
    .fixture small{color:#94a3b8}
    .right{display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .muted{color:#94a3b8}
    .pill{border:1px solid #1e293b;border-radius:999px;padding:6px 10px;font-size:12px;color:#94a3b8}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:900px){.grid2{grid-template-columns:1fr}}
  </style>
</head>
<body>

<header>
  <div style="display:flex;flex-direction:column;gap:4px">
    <div style="font-weight:900;font-size:18px">Rack Café Utd</div>
    <div class="muted" style="font-size:12px">Huddersfield Tuesday Night Pool League · Blackball · 10 Frames</div>
  </div>

  <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end">
    <span id="syncPill" class="badge"><span id="syncDot">●</span><span id="syncText">Checking…</span></span>
    <span class="pill"><span id="headerName">—</span> · <span id="headerRole">—</span></span>
    <button id="logoutBtn" class="secondary">Logout</button>
  </div>
</header>

<nav>
  <button data-tab="dashboard" class="active">Dashboard</button>
  <button data-tab="fixtures">Fixtures</button>
  <button data-tab="table">League Table</button>
  <button data-tab="scoresheets">Scoresheets</button>
  <button data-tab="players">Players</button>
  <button data-tab="admin" id="adminTab" class="hidden">Admin</button>
  <button data-tab="system" id="systemTab" class="hidden">System</button>
</nav>

<div class="container">

  <section id="dashboard">
    <div class="card">
      <h2 style="margin-top:0">Dashboard</h2>
      <div class="grid2">
        <div class="card" style="margin:0">
          <h3 style="margin-top:0">Top Performer</h3>
          <p id="topPerformer">No one yet — no games have been played.</p>
        </div>
        <div class="card" style="margin:0">
          <h3 style="margin-top:0">Team Snapshot</h3>
          <div class="row">
            <div>
              <div class="muted" style="font-size:12px">Matches Confirmed</div>
              <div style="font-size:28px;font-weight:900" id="statMatches">0</div>
            </div>
            <div>
              <div class="muted" style="font-size:12px">Frame Points</div>
              <div style="font-size:28px;font-weight:900" id="statPoints">0</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FIXTURES -->
  <section id="fixtures" class="hidden">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
        <div>
          <h2 style="margin:0">Fixtures</h2>
          <small class="muted">Admins can add/edit/delete fixtures</small>
        </div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button id="addFixtureBtn" class="primary hidden">Add Fixture</button>
        </div>
      </div>

      <div id="fixturesList"></div>

      <div id="fixtureForm" class="card hidden" style="margin-top:14px">
        <h3 style="margin-top:0" id="fixtureFormTitle">Add Fixture</h3>
        <div class="row">
          <input id="fixDate" placeholder="Date (YYYY-MM-DD)" />
          <input id="fixVenue" placeholder="Venue" />
        </div>
        <div class="row" style="margin-top:10px">
          <select id="fixHome"></select>
          <select id="fixAway"></select>
        </div>
        <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
          <button id="saveFixtureBtn" class="primary">Save</button>
          <button id="cancelFixtureBtn" class="secondary">Cancel</button>
        </div>
        <div class="muted" style="margin-top:10px;font-size:12px" id="fixtureFormHint"></div>
      </div>
    </div>
  </section>

  <!-- LEAGUE TABLE -->
  <section id="table" class="hidden">
    <div class="card">
      <h2 style="margin-top:0">League Table</h2>
      <table>
        <thead>
        <tr><th>Pos</th><th>Team</th><th>P</th><th>FF</th><th>FA</th><th>Pts</th></tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>
  </section>

  <!-- SCORESHEETS -->
  <section id="scoresheets" class="hidden">
    <div class="card">
      <h2 style="margin-top:0">Scoresheets (Per Fixture)</h2>

      <label class="muted">Select Fixture</label>
      <select id="fixtureSelect"></select>

      <div style="margin-top:10px">
        <span id="fixtureMeta" class="badge"></span>
        <span id="lockBadge" class="badge hidden" style="margin-left:8px">Locked</span>
      </div>

      <div class="row" style="margin-top:12px">
        <select id="homeTeam" disabled></select>
        <select id="awayTeam" disabled></select>
      </div>

      <div class="frames" id="frames"></div>

      <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
        <button id="saveSheet" class="secondary">Save</button>
        <button id="confirmMatch" class="primary">Confirm Match</button>
      </div>

      <div class="muted" style="margin-top:10px;font-size:12px">
        Only Admins can edit scoresheets. Confirming a match locks it and updates the table.
      </div>
    </div>
  </section>

  <!-- PLAYERS -->
  <section id="players" class="hidden">
    <div class="card">
      <h2 style="margin-top:0">Players</h2>
      <p class="muted" style="margin-top:6px">Players will appear here after they log in for the first time.</p>
      <div id="playersList"></div>
    </div>
  </section>

  <!-- ADMIN -->
  <section id="admin" class="hidden">
    <div class="card">
      <h2 style="margin-top:0">Admin Panel</h2>
      <p class="muted">Admins can add/edit/delete fixtures, edit scoresheets, and confirm matches.</p>
    </div>
  </section>

  <!-- SYSTEM -->
  <section id="system" class="hidden">
    <div class="card">
      <h2 style="margin-top:0">System Creator Panel</h2>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <button id="resetTable" class="secondary">Reset League Table</button>
        <button id="resetSheets" class="secondary">Reset All Scoresheets</button>
      </div>

      <div style="margin-top:14px">
        <label class="muted">Unlock Fixture (override)</label>
        <select id="unlockFixtureSelect"></select>
        <button id="unlockFixtureBtn" class="secondary" style="margin-top:8px">Unlock Selected</button>
      </div>

      <div id="auditLog" style="margin-top:14px"></div>
    </div>
  </section>

</div>

<script type="module" src="./app.js?v=20260127"></script>
</body>
</html>
